## 一

### 思路

管理类 -> 连接池 -> 代理类

管理类直接从连接池获取连接，将用户的方法转发到代理类，代理类负责操作数据库驱动

### 介绍

管理类：负责在操作数据库前自动从连接池里拿到代理类，以及自动回收代理类

连接池：负责发放和回收连接

代理类：负责封装数据库方法和操作数据库，以及断线重连

### 优点

1. 可同时使用不同数据库，只需要在配置文件中设置好服务器所使用的代理类即可

### 缺点

1. 无法自动处理读写分离，需要用户手动选择主从数据库


## 二

### 思想

管理类 -> 查询类 -> 连接池

管理类转发用户的方法到查询类进行第一次处理，再根据情况从连接池获取对应连接进行二次处理。

第一次处理：判断应该使用主或从数据库，封装事务兼容嵌套事务，人性化的数据库操作方法。

第二次处理：根据第一次的处理结果来获取对应连接，从而操作数据库。

### 介绍

管理类：负责在操作数据库时自动调度查询类和连接池

查询类：负责封装数据库方法和操作数据库

连接池：负责发放和回收连接

### 优点

1. 具备自动处理读写分离功能

### 缺点

1. 无法同时使用不同的数据库




流程：

Manager -> Cluster($constructor) -> Mysql -> PDO

Manager: 创建集群，获取连接

Cluster：创建连接池分组，通过构造器创建连接

Mysql：封装驱动方法，断线重连

PDO：操作数据库

示例：

$db = new Manager(array $configs, string|callable $constructor);

$row = $db->first(string $sql, array $arguments = []);

## 二

流程：

Manager -> Cluster -> Mysql -> PDO

Manager: 创建集群，获取连接

Cluster：创建连接池分组，通过构造器创建连接

Mysql：封装驱动方法，断线重连

PDO：操作数据库

示例：

$db = new Manager(array $configs, string|callable $constructor);

$row = $db->first(string $sql, array $arguments = []);

